<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

    <title>Zzish Quick Javascript Client SDK</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>

    <script src="zzish.js"></script>
    <script>
        var activityId; 
            var init = false;

        function initApp() {
            Zzish.init($("#appId").val());
            init = true;
            console.log("App Initalized with id",$("#appId").val());
        }

        function stateless() {
            if (init) {
                Zzish.initState("123456","s2342523523").getUser(1231313,"234243234",function(err,message) {
                    console.log("User" + err + " message" + message);
                })            
            }
            else {
                alert ("Please init with your APP_ID from http://www.zzish.co.uk/developer/")
            }
        }

        function getUser() {
            if (init) {
                Zzish.getUser($("#userId").val(),$("#name").val(),function(err,message) {
                    console.log("User created with status" + err + "for id" + message.uuid);    
                });
                
            }
            else {
                alert ("Please init with your APP_ID from http://www.zzish.co.uk/developer/")
            }
        }

        function startActivity() {
            if (init) { 
                var validRequest = true; 
                if ($("#groupCode").val()!="") {
                    if (Zzish.validateClassCode($("#groupCode").val())) {
                        validRequest = true;
                    }
                    else {
                        validRequest = false;
                    }
                }
                else {
                    validRequest = true;
                }   
                if (validRequest) {
                    activityId = Zzish.startActivity($("#userId").val(),$("#aname").val(),$("#groupCode").val(),function(err,message) {
                        if (err) {
                            console.log("Activity " + message.uuid + "started");        
                        }
                        else {
                            console.log("Error starting" + err)
                        }
                    });
                }
                else {
                    console.log("Invalid Request");
                }
            }
            else {
                alert ("Please init with your APP_ID from http://www.zzish.co.uk/developer/")
            }
            
        }

        function logAction() {
            if (init) {                        
                Zzish.logAction(activityId,$("#actname").val(),$("#response").val(),$("#Score").val(),$("#correct").val(),$("#Duration").val(),$("#Attempts").val(),$("#attributes").val(),function(err,message) {
                    if (err) {
                        console.log("logAction " + message.uuid + "started");        
                    }
                    else {
                        console.log("Error starting" + err)
                    }
                });            
            }
            else {
                alert ("Please init with your APP_ID from http://www.zzish.co.uk/developer/")
            }
        }

        function stopActivity() {
            if (init) {             
                Zzish.stopActivity(activityId,$("#aattributes").val(),function(err,message) {
                    if (err) {
                        console.log("Activity " + message.uuid + "started");        
                    }
                    else {
                        console.log("Error starting" + err)
                    }
                });            
            }
            else {
                alert ("Please init with your APP_ID from http://www.zzish.co.uk/developer/")
            }
        }   

        function cancelActivity() {
            if (init) {                        
                Zzish.cancelActivity(activityId,function(err,message) {
                    if (err) {
                        console.log("Activity " + message.uuid + "cancelled");        
                    }
                    else {
                        console.log("Error starting" + err)
                    }
                });            
            }
            else {
                alert ("Please init with your APP_ID from http://www.zzish.co.uk/developer/")
            }
        }        
    </script>
</head>

<body>
<input type="text" id="appId" name="appId" placeholder="Your API Key" value=""/><br/>
<input type="button" onclick="initApp()" value="Initialise"/><br/>
<h1>Create user</h1>
<input type="text" id="userId" name="userId" placeholder="userId" value=""/><br/>
<input type="text" id="name" name="name" placeholder="Name" value=""/><br/>
<input type="button" onclick="stateless()" value="Create User"/><br/>
<br/>
<h1>Start Activity</h1>
<input type="text" id="groupCode" name="groupCode" placeholder="Class code" value=""/><br/>
<input type="text" id="aname" name="aname" placeholder="Activity Name" value=""/><br/>
<input type="button" onclick="startActivity()" value="Start Activity"/><br/>
<h1>Create Action</h1>
<input type="text" id="actname" name="actname" placeholder="Action Name" value=""/><br/>
<input type="text" id="response" name="response" placeholder="Response" value=""/><br/>
<input type="text" id="Score" name="actname" placeholder="Score" value=""/><br/>
<input type="text" id="Duration" name="actname" placeholder="Duration" value=""/><br/>
<input type="text" id="Attempts" name="actname" placeholder="Attempts" value=""/><br/>
<input type="text" id="correct" name="actname" placeholder="correct" value=""/><br/>
<input type="text" id="attributes" name="attributes" placeholder="Action State (JSON)" value=""/><br/>
<input type="button" onclick="logAction()" value="Log Action"/><br/>
<br/>
<h1>Complete Activity</h1>
<input type="text" id="aattributes" name="aattributes" placeholder="Activity State (JSON)" value=""/><br/>
<input type="button" onclick="stopActivity()" value="Complete Activity"/><br/>
<h1>Cancel Activity</h1>
<input type="button" onclick="cancelActivity()" value="Cancel Activity"/><br/>

</body>
</html>